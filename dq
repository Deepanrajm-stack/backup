| **Function/Section**                          | **Purpose**                                                                                                                                                          |
| --------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **1. Load Config & Table**                    | Loads configuration parameters and reads the latest snapshot from the `routingiq_json_input_data` Delta table.                                                       |
| **2. DQ1: Duplicate Check**                   | Checks for duplicate `customer_id` values.                                                                                                                           |
| **3. DQ2–DQ7: Not Null Checks**               | Ensures critical fields like `customer_id_masked`, `valuation_segment`, `qtr_planned_calls`, `urgent_alerts`, `address_priority`, and `priority_score` are not null. |
| **4. DQ8: Address Validation**                | Ensures `address_id` and `full_address` are not null.                                                                                                                |
| **5. DQ9: Geolocation Check**                 | If `customer_id` is present, checks that both `latitude` and `longitude` are not null.                                                                               |
| **6. DQ10–DQ12: Weekly Time Window Checks**   | Validates start/end time consistency across Monday to Friday. Triggers failures if one is present without the other.                                                 |
| **7. DQ13: Null `rep_id` Check**              | Ensures `rep_id` is not null.                                                                                                                                        |
| **8. DQ14: Rep Geolocation Check**            | Validates that `latitude_rep` and `longitude_rep` are not null.                                                                                                      |
| **9. DQ15: Rep Duplicate Coordinates Check**  | Checks for duplicate combinations of `rep_id`, `latitude_rep`, and `longitude_rep`.                                                                                  |
| **10. Aggregate DQ Failures**                 | Combines all DQ failures into a single DataFrame for reporting.                                                                                                      |
| **11. Generate Summary & Email Notification** | If failures exist: <ul><li>Generates summary table</li><li>Exports sample records to Excel</li><li>Sends an HTML email with summary + attachment</li></ul>           |
| **12. Excel Attachment**                      | Saves sample DQ failures in `DQ_Failures_Sample.xlsx` using `openpyxl` and `pandas`.                                                                                 |
| **13. Email Sending Block**                   | Uses `smtplib` and `email.mime` to send email to the configured recipients (currently: `dmuniraj@amgen.com`).                                                        |
