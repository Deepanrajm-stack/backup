from pyspark.sql.functions import col, lit
 
# Load full rep_routing_alignment table
df_rep_full = spark.table(dev_rep_routing_alignment_table)
 
# Get max processing_date for rep_routing_alignment
max_date_rep = df_rep_full.agg({"processing_date": "max"}).collect()[0][0]
 
# Filter rep table to only latest date
df_rep = df_rep_full.filter(col("processing_date") == lit(max_date_rep))
 
# -----------------------------------------------
 
# Load full routingiq_json_input_data table
df_json_full = spark.table(routingiq_json_input_data_table)
 
# Get max processing_date for routingiq_json_input_data
max_date_json = df_json_full.agg({"processing_date": "max"}).collect()[0][0]
 
# Filter json table to only latest date
df_json = df_json_full.filter(col("processing_date") == lit(max_date_json))
